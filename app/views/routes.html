<div class="root">

  <main-menu></main-menu>

  <div class="main-container">

    <section-header ng-show="('routes' | routeSegmentEqualsTo)"
                    title="Routes"
                    icon="fas fa-route"
                    show-search-input="true">
    </section-header>

    <section-header ng-show="('routes.new_route' | routeSegmentEqualsTo)"
                    title="Routes - New Route"
                    icon="fas fa-route"
                    show-search-input="false"
                    show-close="true"
                    close-function="routes.goToRoutes()">
    </section-header>

    <section-header ng-show="('routes.edit_route.route_id' | routeSegmentEqualsTo)"
                    title="Routes - Edit Route"
                    icon="fas fa-route"
                    show-search-input="false"
                    show-close="true"
                    close-function="routes.goToRoutes()">
    </section-header>

    <div class="main-container-inner" ng-show="('routes' | routeSegmentEqualsTo)">

      <table class="tabla">
        <thead>
        <tr>
          <th>Date</th>
          <th>Name</th>
          <th>City</th>
          <th>Province</th>
          <th>Country</th>
          <th>Challenges</th>
          <th>Options</th>
        </tr>
        </thead>
        <tbody ng-repeat="route in routes.routes track by $index">
        <tr>

          <td>{{route.date | date : 'dd/MM/yyyy'}}</td>
          <td class="bold">{{route.name}}</td>
          <td>{{route.city}}</td>
          <td>{{route.province}}</td>
          <td>{{route.country}}</td>
          <td>{{route.challenges.length}}</td>
          <td class="option">

            <div class="rombo-table-write" ng-click="routes.editRoute(route.id)">
              <i class="fas fa-edit logo1"></i>
            </div>
            <!--ng-click="routes.deleteRow($index)"-->
            <div class="rombo-table-delete" ng-click="showDeletePopup[$index] = !showDeletePopup[$index]">
              <i class="fas fa-trash-alt logo2"></i>
            </div>
            <!--ng-click="showOptions[$index] = !showOptions[$index]"-->
            <div class="rombo-table-see"
                 ng-class="{ 'rombo-table-see-selected' : showChallenges[$index] === true }"
                 ng-click="showChallenges[$index] = !showChallenges[$index]; routes.getChallengesByRouteId(route.id)">
              <i class="fas fa-eye logo3"></i>
            </div>

            <div class="bg-popup" ng-show="showDeletePopup[$index]">

              <div class="popup-container">
                <span>are you sure you want to delete this route?</span>
                <h5 class="bold">{{route.name}}</h5>
                <div class="popup-buttons-container">
                  <button class="delete-button" ng-click="routes.deleteRoute(route.id); showDeletePopup[$index] = false">Delete</button>
                  <button class="cancel-button"  ng-click="showDeletePopup[$index] = false">Cancel</button>
                </div>
              </div>

            </div>

          </td>
        </tr>
        <tr ng-show="showChallenges[$index] === true">
          <td colspan="7">
            <table id="table-2" class="table-see">
              <tr>
                <th scope="col">Date</th>
                <th scope="col">Name</th>
                <th scope="col">Period</th>
                <th scope="col">Unit</th>
                <th scope="col">Bonus</th>
                <th scope="col">Video</th>
                <th scope="col">Images</th>
                <th scope="col">Options</th>
              </tr>
              <tr ng-repeat="challenge in routes.challengesLoaded">
                <td>{{challenge.date | date : 'dd/MM/yyyy'}}</td>
                <td class="bold">{{challenge.name}}</td>
                <td>{{challenge.period}}</td>
                <td>{{challenge.unit}}</td>
                <td>{{challenge.bonus}}</td>
                <td>{{challenge.video}}</td>
                <td>{{challenge.images.length}}</td>
                <td class="option">

                  <div class="rombo-table-write" ng-click="routes.editChallenge(challenge.id)">
                    <i class="fas fa-edit logo1"></i>
                  </div>

              </tr>

            </table>
          </td>
        </tr>

        </tbody>

      </table>

    </div>

    <div app-view-segment="1" ng-show="('routes.new_route' | routeSegmentEqualsTo)"></div>

    <div app-view-segment="2" ng-show="('routes.edit_route.route_id' | routeSegmentEqualsTo)"></div>

    <new-button icon="fas fa-plus"
                title="New Route"
                button-function="routes.goToNewRoute()"
                ng-hide="('routes.new_route' | routeSegmentEqualsTo)">
    </new-button>

  </div>


</div>
